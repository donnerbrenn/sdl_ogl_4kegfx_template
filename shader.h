/* File generated with Shader Minifier 1.1.5
 * http://www.ctrl-alt-test.fr
 */
#ifndef SHADER_H_
# define SHADER_H_
# define VAR_COLOR "m"
# define VAR_RUNTIME "v"

const char *shader_frag =
 "#version 400\n"
 "uniform float v[2];"
 "float y=10000.,f=v[0];"
 "out vec3 m;"
 "vec3 n(vec3 m,vec3 v)"
 "{"
   "float y=cos(v.x),f=sin(v.x),x=cos(v.y),z=sin(v.y),n=cos(v.z),l=sin(v.z);"
   "mat3 r=mat3(vec3(1,0,0),vec3(0,y,-f),vec3(0,f,y));"
   "r*=mat3(vec3(x,0,z),vec3(0,1,0),vec3(-z,0,x));"
   "return r*mat3(vec3(n,-l,0),vec3(l,n,0),vec3(0,0,1))*m;"
 "}"
 "float n(vec3 v,vec3 m,float y)"
 "{"
   "vec3 f=abs(v)-m;"
   "return length(max(f,0.))+min(max(f.x,max(f.y,f.z)),0.)-y;"
 "}"
 "float x(vec3 v,vec2 f,float y)"
 "{"
   "return min(min(n(v,f.xyy,y),n(v,f.yxy,y)),n(v,f.yyx,y));"
 "}"
 "float n(vec3 v)"
 "{"
   "float y=n(n(v+vec3(0,2.5,0),vec3(1.,0.,0.)),vec3(40,16,.1),0.);"
   "v=n(v,vec3(f*.5,f*.5,.5));"
   "float m=x(v,vec2(4.5,.89),.1),l=n(v,vec3(1.),.25);"
   "m=max(l,-m);"
   "m=min(m,n(n(v,vec3(vec2(sin(f*1.12)),0.)),vec3(.4),0.));"
   "m=mix(l,m,sin(f)*.5+.5);"
   "return min(m,y);"
 "}"
 "vec3 x(vec3 v)"
 "{"
   "vec2 m=vec2(1./y,0);"
   "return normalize(vec3(n(v+m.xyy)-n(v-m.xyy),n(v+m.yxy)-n(v-m.yxy),n(v+m.yyx)-n(v-m.yyx)));"
 "}"
 "float e(vec3 v,vec3 y,float m)"
 "{"
   "return(dot(v,normalize(y))*.5+.5)*m;"
 "}"
 "float e(vec3 v,vec3 y,vec3 m,float x)"
 "{"
   "vec3 f=reflect(normalize(y),v);"
   "return pow(max(dot(m,f),0),128)*x;"
 "}"
 "float e(vec3 v,vec3 y)"
 "{"
   "float m=1-abs(length(v-y))/100.;"
   "return pow(m,32.)*1.5;"
 "}"
 "float e(vec3 v,vec3 m,float f,float x,float z)"
 "{"
   "float l=1.,r=1e+20;"
   "for(float e=f;e<x;)"
     "{"
       "float s=n(v+m*e);"
       "if(s<1./y)"
         "return 0;"
       "float p=s*s/(2.*r),c=sqrt(s*s-p*p);"
       "l=min(l,z*c/max(0.,e-p));"
       "r=s;"
       "e+=s;"
     "}"
   "return l;"
 "}"
 "void main()"
 "{"
   "vec2 f=gl_FragCoord.xy/vec2(v[1])-vec2(.5,.25);"
   "vec3 l=vec3(f*2,-5.),z=l,r,s=normalize(vec3(f,1.));"
   "bool p;"
   "float c;"
   "for(int i=0;i<500&&c<30.;i++)"
     "{"
       "c=length(l-z);"
       "float d=n(z);"
       "if(d<1./y)"
         "{"
           "p=true;"
           "break;"
         "}"
       "z+=s*d;"
     "}"
   "r=x(z);"
   "if(p)"
     "{"
       "vec3 i,d=vec3(.1,.25,-.2),t=vec3(-.1,.15,-.25),o=vec3(-1,.5,.25);"
       "i+=vec3(e(z,d)*e(r,d,.75)+e(r,d,s,.45));"
       "i+=e(z,t)*e(r,t,.525)+e(r,t,s,.35);"
       "i+=e(z,o)*e(r,o,.225)+e(r,o,s,.725);"
       "m=i*vec3(.1,.5,.1);"
       "vec3 a=l+c*s;"
       "m=mix(vec3(0.),m,e(a,normalize(d),.01,length(c*s),50.)*.25+.75);"
     "}"
   "m*=mix(m,vec3(1.,1.,1.),1-exp(-.1*pow(c,256.)));"
   "m-=c*.0125;"
 "}";

#endif // SHADER_H_
